#textdomain wesnoth-Bad_Moon_Rising
[scenario]
	id="2_07_Salvation"
	name= _ "All Dreams Die"
	map_data="{@campaigns/Bad_Moon_Rising/maps/2_07_Salvation3.map}"
	next_scenario=2_07_Epilogue
	victory_when_enemies_defeated=no
	{TURNS -1 -1 -1}
	[music]
	name="underground.ogg"
	[/music]

	{BMR_DAYSHORT}

	[event]
	name=prestart
		[objectives]
		side=3
			[objective]
			condition=win
			description=_ "Reach the keep in the mountains"
			[/objective]
			[objective]
			condition=lose
			description=_ "Death of Raena"
			[/objective]
			[objective]
			condition=lose
			description=_ "Belleros arrives before Raenna reaches the keep"
			[/objective]
			note= _ "This is the final scenario."
		[/objectives]
	[item]
        x=64
        y=30
        image="scenery/monolith1.png"
        [/item]
	[item]
        x=52
        y=6
        image="items/ball-blue.png"
        [/item]
	[item]
        x=25
        y=2
        image="items/chest-plain-closed.png"
        [/item]
	[set_variable]
	name=has_sphere
	value=0
	[/set_variable]	
	[set_variable]
	name=open_cave
	value=0
	[/set_variable]	
	[set_variable]
	name=mono
	value=0
	[/set_variable]
	[set_variable]
	name=rand2
	value=0
	[/set_variable]
	[remove_shroud]
	side=1
	x=0-81
	y=0-71
	[/remove_shroud]
	[remove_shroud]
	side=3
	x=0-81
	y=0-71
	[/remove_shroud]
	[place_shroud]
	side=3
	x=10-50
	y=1-11
	[/place_shroud]
	[place_shroud]
	side=3
	x=20-65
	y=12-27
	[/place_shroud]
	[place_shroud]
	side=3
	x=40-56
	y=28-36
	[/place_shroud]
	[place_shroud]
	side=1
	x=10-50
	y=1-11
	[/place_shroud]
	[place_shroud]
	side=1
	x=20-65
	y=12-27
	[/place_shroud]
	[place_shroud]
	side=1
	x=40-56
	y=28-36
	[/place_shroud]
	[redraw][/redraw]
 # Belleros, Ares, Echidna are not on the map at first
	[store_unit]
	    [filter]
		id=C_Belleros
	    [/filter]
		variable=c_belleros
		kill=yes
	[/store_unit]
	[store_unit]
	    [filter]
		id=Echidna
	    [/filter]
		variable=echidna
		kill=yes
	[/store_unit]
	[store_unit]
	    [filter]
		id=Ares
	    [/filter]
		variable=ares
		kill=yes
	[/store_unit]
	[/event]

	{FLAMES 23 4}
	{FLAMES 27 4}
	{FLAMES 44 10}
	{FLAMES 46 11}


	[side]
	type=Ukian Subcommander
	id=C_Belleros
	name= _ "Belleros"
	profile="portraits/c_belleros.png"
        ellipse="misc/ellipse-hero"
	        [modifications]
	        {TRAIT_STRONG}
	        {TRAIT_RESILIENT}
	        [/modifications]
        unrenamable=yes
	side=1
	canrecruit=yes
	controller=human
	fog=no
	shroud=yes
	[ai]
	aggression=0.8
	grouping=offensive
	passive_leader=yes
	caution=1.0
	village_value=0
	[/ai]
	recruit=Ukian Runner, Ukian Regular, Ukian Archer, Ukian Dog
	{GOLD 250 200 150}
	{INCOME 8 6 4}
	team_name=good
	[/side]

	[side]
	type=Primeval Storm
	id=Athanta
	name= _ "Athanta"
	        [modifications]
	        {TRAIT_STRONG}
	        {TRAIT_RESILIENT}
	        [/modifications]
        unrenamable=yes
	side=2
	canrecruit=yes
	controller=ai
	fog=no
	recruit=Primeval Swiftfoot, Primeval Striker, Primeval Ironwheel
 	{GOLD 280 220 160}
 	{INCOME 16 12 8}
		[ai]
		aggression=0.8
		grouping=offensive
		    [protect_location]
			x=62-67
			y=28-31
			value=500
		    [/protect_location]
		    [leader_goal]
			x,y=61,36
		    [/leader_goal]
		village_value=0
		caution=0.8
		[/ai]
	team_name=primeval
	[unit]
	type=Primeval Slasher
	generate_name=yes
	random_traits=yes
	x,y=69,5
#	ai_special=guardian
	[/unit]
	[unit]
	type=Primeval Slasher
	generate_name=yes
	random_traits=yes
	x,y=72,1
#	ai_special=guardian
	[/unit]
	[unit]
	type=Primeval Slasher
	generate_name=yes
	random_traits=yes
	x,y=71,9
	[/unit]
	[/side]

	[side]
	type=Bad Raenna
	id=Raenna
	name= _ "Raenna"
	        [modifications]
# RQ=117 QR=?
	        {TRAIT_QUICK}
	        {TRAIT_RESILIENT}
	        [/modifications]
        unrenamable=yes
	side=3
	canrecruit=yes
	fog=no
	shroud=yes
	controller=human
	recruit=Primevalist Fighter, Primevalist Follower, Primevalist Fanatic, Primevalist Monk
	{GOLD 300 250 200}
	{INCOME 11 9 7}
	team_name=primeval
        [unit]
        type=Primevalist Fanatic
	id=Follower1
	generate_name=yes
	random_traits=yes
        x,y=68,5
#	ai_special=guardian
        [/unit]
        [unit]
        type=Primevalist Monk
	id=Follwer2
	generate_name=yes
	random_traits=yes
        x,y=73,3
#	ai_special=guardian
        [/unit]
	[/side]


	[side]
	side=4
	type=Echidna
	id=Echidna
	name= _ "Carghanna"
	        [modifications]
	        {TRAIT_STRONG}
	        {TRAIT_RESILIENT}
	        [/modifications]
        unrenamable=yes
	canrecruit=yes
	controller=ai
	fog=no
	team_name=khthon
	recruit=Ukian Runner, Ukian Regular, Ukian Archer, Ukian Veteran, Ukian Seeress, Ukian Hawkeye, Ukian Dog
	{GOLD 290 360 430}
	{INCOME 14 18 22}
	[ai]
	aggression=0.8
	grouping=offensive
	    [protect_location]
		x=62-68
		y=28-33
		value=500
	    [/protect_location]
	    [target]
		side=2
		value=600
	    [/target]
	    [target]
		side=3
		value=500
	    [/target]
	    [target]
		side=5
		value=500
	    [/target]
	passive_leader=yes
	caution=0.8
	[/ai]
	[unit]
	type=Chimera
	random_traits=yes
	id=Chimera
	name= _ "Chimera"
	x,y=64,30
	ai_special=guardian
	[/unit]
	[unit]
	type=Orthrus
	random_traits=yes
	generate_description=yes
	x,y=62,31
	ai_special=guardian
	[/unit]
	[unit]
	type=Orthrus
	random_traits=yes
	generate_description=yes
	x,y=66,31
	ai_special=guardian
	[/unit]
	[/side]	


	[side]
	type=Primeval Ares
	id=Ares
	name= _ "Ares"
	profile=portraits/ares.png
	        [modifications]
	        {TRAIT_STRONG}
	        {TRAIT_RESILIENT}
	        [/modifications]
        unrenamable=yes
	side=5
	canrecruit=yes
	controller=ai
	fog=no
	recruit=Primeval Slow, Primeval Driver, Primeval Swiftfoot, Primeval Striker, Primeval Ironwheel
	{GOLD 340 410 480}
	{INCOME 18 24 30}
	[ai]
	aggression=0.8
	grouping=offensive
	    [protect_location]
		x=18-25
		y=3-10
		value=50
	    [/protect_location]
	    [leader_goal]
		x,y=61,36
	    [/leader_goal]
	caution=0.8
	village_value=0
	[/ai]
	team_name=primeval
	[/side]

	[side]
	side=6
	controller=ai
	no_leader=yes
	team_name=khthon
	   [ai]
	    [target]
		side=2
		value=600
	    [/target]
	    [target]
		side=3
		value=500
	    [/target]
	    [target]
		side=5
		value=500
	    [/target]
	    aggression=0.8
	    caution=0.7
	   [/ai]
	[/side]

# core macros
	{LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Primeval Striker" 2}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 2 "Primeval Ironwheel" 2}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Ukian Hawkeye" 2}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Ukian Seeress" 2}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 4 "Ukian Veteran" 2}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Primeval Striker" 3}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Primeval Ironwheel" 3}
	{LIMIT_CONTEMPORANEOUS_RECRUITS 5 "Primeval Driver" 3}
	{FORCE_CHANCE_TO_HIT race=khthon id=Athanta 10 (
	# Raenna has not reached the keep, Belleros has not shown up
		[variable]
		    name=mono
		    numerical_equals=0
		[/variable]
	)}
	{OBJ_POTION_STRONG 56 29 St1}

# custom
	{OBJ_RING_ANCIENT 15 3 Anc1}
	[event]
	name=moveto
	    [filter]
		side=3
		x,y=25,2
	    [/filter]
		[message]
		speaker=unit
		message= _ "This must be treasure Belleros was lugging around?  In any case, it's 250 gold."
		[/message]
		[gold]
		amount=250
		side=3
		[/gold]
		[removeitem]
		x,y=25,2
		[/removeitem]
		[item]
		x,y=25,2
		image="items/chest-plain-open.png"
		[/item]
	[/event]

	[event]
	name=start
	[music]
	name="knalgan_theme.ogg"
	immediate=yes
	[/music]
	[message]
		speaker=Athanta 
		message = _ "It is unfortunate that you could not turn your friends, but we may be able to cut them off.  They must not gain control of the fortress to our west."
	[/message]
	[message]
		speaker=narrator
		message = _ "Raenna was beginning to remember what had happened in the cave.  Recollections of the villain Scarrion set off warning sigals in her head, though she was having a hard time pinning down what it meant.  Her mind was still a little clouded."
		image="wesnoth-icon.png"
	[/message]
	[message]
		speaker=Raenna 
		message = _ "What are these 'dark spirits' Belleros serves?  What will happen if he reaches the fortress?"
	[/message]
	[message]
		speaker=Athanta 
		message = _ "What will happen?  To us, not much.  But your kind, and all similar, will lose your...  souls.  The dark spirits are a pernicious enemy, more like a disease than an entity.  They posses and control the bodies of the living, given enough fuel they spread throughout the population of victims like an ill vapor."
	[/message]
	[message]
		speaker=Athanta 
		message = _ "If your friends reach the fortress, they will deliver unto the spirits enough fuel to spread over this land.  The few survivors will die at the hands of their former kin.  My kind does not wish to fight vast armies of the damned, so it is vital to all that we do not let that happen."
	[/message]
	[message]
		speaker=Follower1 
		message = _ "It looks like there are guardians, of sorts."
	[/message]
	[scroll_to]
	    x,y=64,30
	[/scroll_to]
	[delay]
	    time=650
	[/delay]
	[message]
		speaker=Athanta 
		message = _ "Let's move."
	[/message]
	[/event]

	[event]
	name=new turn
	first_time_only=no
	    [set_variable]
		name=rand1
		rand=Yak,Ram,"Arctic Wolf",Yak,Ram,"Arctic Wolf",Orthrus,Ophis
	    [/set_variable]
# one of two spawn points, might want to add to this at some point.
	    [set_variable]
		name=rand2
		rand=1,80
	    [/set_variable]
	    [unit]
		side=6
		type=$rand1
		generate_description=no
		random_traits=yes
		x,y=$rand2,17
	    [/unit]
	    [if]
		[variable]
		name=mono
		numerical_equals=0
		[/variable]
# if Belleros is here (mono = 1), start the countdown for Ares to arrive
		[else]
		[set_variable]
		name=mono
		add=1
		[/set_variable]
		[/else]
	    [/if]
	    [if]
	        [variable]
		name=mono
# this should only trigger once, this value (6) can be graded for difficulty
		numerical_equals=6
		[/variable]
		[then]
		[unstore_unit]
		    variable=ares
		[/unstore_unit]
	[music]
	name="suspense.ogg"
	immediate=yes
	[/music]
		[message]
		speaker=Ares
		message= _ "We will crush them, just don't let them enter the cavern."
		[/message]
		[message]
		speaker=Athanta
		message= _ "Has Nemesis fallen?  Where is she?"
		[/message]
		[message]
		speaker=Ares
		message= _ "She has a plan, and will join us in a while."
		[/message]
		[/then]
	    [/if]
	[/event]

# Athanta starts to head towards the mountain keeps
# This stuff does not work (1.6a), [leader_goal] may not be supported in a modify_side?
#	[event]
#	name=turn 2
#		[modify_side]
#		[ai]
#		aggression=0.8
#		grouping=offensive
#		    [protect_location]
#			x=62-67
#			y=28-31
#			value=500
#		    [/protect_location]
#		    [leader_goal]
#			x,y=68,34
#		    [/leader_goal]
#		village_value=0
#		caution=0.8
#		[/ai]
#		[/modify_side]
#	[/event]

# Athanta moves to the other keep, and is less aggressive.
# This stuff does not work (1.6a), [leader_goal] may not be supported in a modify_side?
#	[event]
#	name=moveto
#	    [filter]
#		id=Athanta
#		x,y=68,34
#	    [/filter]
#		[modify_side]
#		    [ai]
#			aggression=0.6
#			grouping=offensive
#		    [protect_location]
#			x=62-67
#			y=28-31
#			value=500
#		    [/protect_location]
#			[leader_goal]
#			x,y=61,36
#			[/leader_goal]
#			village_value=0
#			caution=0.9
#		    [/ai]
#		[/modify_side]
#	[/event]
		
# Belleros shows up once Raenna reaches the keep.  I should probably change this to a timed event, but this will do for now.
	[event]
	name=moveto
	    [filter]
		id=Raenna
		x=67-69
		y=33-35
	    [/filter]
		[message]
		speaker=Raenna
		message= _ "We've made it to the top.  It's not clear what we need to do..."
		[/message]
	[music]
	name="legends_of_the_north.ogg"
	immediate=yes
	[/music]
		[message]
		speaker=Athanta
		message= _ "Look who's here..."
		[/message]

		[unstore_unit]
		variable=c_belleros
		[/unstore_unit]
		    [recall]
 		       type=Ukian Deadeye
		    [/recall]

		[message]
		speaker=C_Belleros
		message= _ "The demons are already at the peak, are we too late?"
		[/message]
        [delay]
        time=150
        [/delay]
        [colour_adjust]
                red,green,blue=-40,30,-40
        [/colour_adjust]
        [delay]
        time=150
        [/delay]
        [colour_adjust]
                red,green,blue=-80,60,-80
        [/colour_adjust]
        [message]
                speaker=narrator
                caption="Carghanna"
                message= _ "No, it is not too late.  The monsters are enemies of the demons, it should buy us some time.  Lay your hands upon the monolith up ahead, and we will be able to slip past the demons and into more defensible territory."
        [/message]
		[scroll_to]
		x,y=64,29
		[/scroll_to]
	        [delay]
	        time=250
        	[/delay]
	
        [colour_adjust]
                red,green,blue=-40,30,-40
        [/colour_adjust]
        [delay]
        time=150
        [/delay]
        [colour_adjust]
                red,green,blue=-10,-10,0
        [/colour_adjust]
                [delay]
                time=100
                [/delay]
		[message]
		speaker=C_Belleros
		message= _ "We need to reach that monolith up ahead, it will allow us to gain the upper hand against the demons.  But we must hurry!"
		[/message]
		[message]
		type="Ukian Deadeye"
		message= _ "Right."
		[/message]
		[message]
		speaker=Raenna
		message= _ "(The monolith...)"
		[/message]
		[set_variable]
		name=mono
		value=1
		[/set_variable]
		[objectives]
		side=1
			[objective]
			condition=win
			description=_ "Reach the Monolith"
			[/objective]
			[objective]
			condition=lose
			description=_ "Death of Belleros"
			[/objective]
		[/objectives]
	[/event]

# Athanta has served her purpose
		
	[event]
	name=last breath
		[filter]
		id=Athanta
		[/filter]
		[message]
		speaker=unit
		message=_   "This gains you nothing, Echidna...  You vermin will be exterminated..."
		[/message] 
		[message]
		speaker=Raenna
		message=_   "Huh."
		[/message] 
	[/event]

# Raenna is the hero now.
	[event]
	name=die
		[filter]
		id=Raenna
		[/filter]
		[message]
		speaker=narrator
		message= _ "Any hope for the world died along with Raenna.  The victor of this battle, demon or spirit, would usher forth a new distopia."
		[/message]
		[endlevel]
		result=defeat
		[/endlevel]
	[/event]

	[event]
	name=moveto
		[filter]
		    id=C_Belleros
		    x,y=57-65,34-41
		[/filter]
		[message]
		speaker=C_Belleros
		message= _ "Raenna!  Stop this madness, let me reach the monolith..."
		[/message]
		[message]
		speaker=Raenna
		message= _ "Am I the mad one?  What exactly do you think is going to happen if you touch that monolith?"
		[/message]
		[message]
		speaker=C_Belleros
		message= _ "What do you think will happen if I don't!?  Are you really so far gone?  We were happy back in the south, remember?  You, Lorenzon, and I had shepherded our people to a better land.  Scarrion and these - these things - ruined everything.  Lorenzon and many others are now dead, and we will all be crushed under the demonic horde if you do not let me pass!"
		[/message]
		[message]
		speaker=Raenna
		message= _ "How do you know this?"
		[/message]
		[message]
		speaker=Raenna
		message= _ "Carghanna told me.  She has a plan to save us."
		[/message]
		[message]
		speaker=Athanta
		message= _ "*-(snort!)-"
		[/message]
		[message]
		speaker=Raenna
		message= _ "Belleros, Belleros...  What can I say?"
		[/message]
	[/event]		

# Belleros reaches the monolith, Echidna shows up and take control.  Now Raenna and Primevals must fight through the Ukians.

	[event]
	name=moveto
		[filter]
		id=C_Belleros
# for testing
#		x,y=54,65
		x,y=64,30
		[/filter]
	[message]
	speaker=C_Belleros
	message= _ "The monolith is getting warmer, what does it mean..."
	[/message]
	[modify_side]
	side=1
	controller=ai
	[/modify_side]		
	[kill]
	id=Chimera
	animate=yes
	[/kill]
	[music]
	name="the_city_falls.ogg"
	immediate=yes
	[/music]
	[colour_adjust]
	red=-50
	green=60
	blue=-50
	[/colour_adjust]
	[message]
	speaker=narrator
	message= _ "Well, Belleros..."
	caption= _ "Carghanna"
	[/message]
	[move_unit_fake]
	type=BMR Spark
	side=4
	x=64,64
	y=23,29
	[/move_unit_fake]
	[unstore_unit]
	variable=echidna
	[/unstore_unit]
	[message]
	speaker=Echidna
	message= _ "Thank you.  Now we can start raising forces to combat these foul ones."
	[/message]
	[colour_adjust]
	red=-60
	green=80
	blue=-60
	[/colour_adjust]
	[message]
	speaker=C_Belleros
	message= _ "What?  What's happening-"
	[/message]
	[set_variable]
	name=open_cave
	value=1
	[/set_variable]
	{QUAKE "rumble.ogg"}
	[terrain]
	terrain=Uu
	x=62-64
	y=26-28
	[/terrain]
	[redraw][/redraw]
 # make the Ukians glow (<-broken) and be on the other side
	{MODIFY_UNIT (
	side=1 
	) halo "halo/echidna.png"}
	[colour_adjust]
	red=-50
	green=60
	blue=-50
	[/colour_adjust]
	[colour_adjust]
	red=0
	green=0
	blue=0
	[/colour_adjust]
	[message]
	speaker=Echidna
	message= _ "Come! Let us secure our triumph."
	[/message]
	[message]
	speaker=C_Belleros
	message= _ "Yes, Carghanna..."
	[/message]
	{MOVE_UNIT id=Echidna 56 15}
	{MOVE_UNIT id=C_Belleros 55 15}	
	[store_unit]
		[filter]
		id=C_Belleros
		[/filter]
		variable=c_belleros
		kill=yes
	[/store_unit]	
	[store_unit]
		[filter]
		id=Echidna
		[/filter]
		variable=echidna
		kill=yes
	[/store_unit]
	[redraw][/redraw]
	[set_variable]
		name=c_belleros.x
		value=25
	[/set_variable]
	[set_variable]
		name=c_belleros.y
		value=8
	[/set_variable]
	[set_variable]
		name=echidna.x
		value=47
	[/set_variable]
	[set_variable]
		name=echidna.y
		value=7
	[/set_variable]
	[unstore_unit]
		variable=echidna
	[/unstore_unit]
 # put Belleros under under ai control and on Echidna's team
 # this is not firing - it does fire, but the turn needs to end?
	[modify_side]
	side=1
	controller=ai
	[/modify_side]		
	[modify_side]
	side=1
	team_name=khthon
	[/modify_side]		
	[modify_side]
	side=1
# grade this for difficulty
	gold=250
	[/modify_side]		
	[message]
	speaker=Raenna
	message= _ "What-  What is going on - THAT'S Carghanna?"
	[/message]
	[message]
	speaker=Athanta
	message= _ "Your friends are no more.  I'm sorry it had to come to this..."
	[/message]
		[objectives]
		side=3
			[objective]
			condition=win
			description=_ "Defeat Carghanna"
			[/objective]
			[objective]
			condition=lose
			description=_ "Death of Raenna"
			[/objective]
		[/objectives]
	[modify_side]
	side=4
	[ai]
	aggression=0.9
	grouping=defensive
	caution=0.6
	    [target]
		id=Ares
		value=600
	    [/target]
	    [target]
		id=Athanta
		value=400
	    [/target]
	    [target]
	        id=Raenna
		value=400
	    [/target]
	    [protect_location]
		x=46-56
		y=1-10
		value=500
	    [/protect_location]
	[/ai]
	[/modify_side]
	{GENERIC_UNIT 6 "Giant Spider" 47 23}
	{GENERIC_UNIT 6 "Giant Spider" 48 16}
# kill the recall list to prevent the save-games from failing
# leave the units on the map alone
	[kill]
	side=1
	x,y=recall,recall
	animate=no
	[/kill]
	[/event]

	
# Raenna catches up to Echidna.  Nemesis swoops in, sets of the power source to explode.  
# Echidna flees, Nemesis close behind.  Raenna & Primevalists learn of Primeval plan.
	[event]
	name=moveto
	    [filter]
		id=Raenna
		x,y=44-48,4-9
	    [/filter]
		[message]
		speaker=Raenna
		message= _ "Carghanna!  What are you doing!?  Please say you have a plan."
		[/message]
		[message]
		speaker=Echidna
		message= _ "Carghanna?  Yes, I suppose it appears that way...  Carghanna is one of us now, you will join her soon enough.  Rest assured that I do have a plan, though I will not tell you now."
		[/message]
		[unit]
		type=Primeval Nemesis
		id=Nemesis
		name="Nemesis"
		random_traits=yes
		side=5
		x,y=53,1
		[/unit]
		{MOVE_UNIT id=Nemesis 56 5}
		[message]
		speaker=Nemesis
		message= _ "Your plans are not worth listening to anyway, for they are but dreams."
		[/message]
		[message]
		speaker=Echidna
		message= _ "How - you-" 
		[/message]
		[message]
		speaker=Nemesis
		message= _ "With your power source, we will blow the top off of this volcano!  We need not fight your slaves, for we will win through attrition:  The ash from the cinder-head will blot out the sun, and all shall perish but us.  We shall inherit this land."
		[/message]		
		[message]
		speaker=Raenna
		message= _ "Whoa...  What!?"
		[/message]
		{MOVE_UNIT id=Nemesis 52 6}
		[message]
		speaker=Nemesis
		message= _ "*-(Whack)-
Do not worry, Raenna, you will not die with them.  You can spend your days as one of us."
		[/message]		
		[role]
		    role=Follower3
		    type="Primevalist Fighter","Primevalist Follower","Primevalist Fanatic","Primevalist Monk"
		[/role]
		[message]
		role=Follower3
		message= _ "And what about us?  What will happen to us?"
		[/message]
		[message]
		speaker=Raenna
		message= _ "..."
		[/message]
		[message]
		speaker=Echidna
		message= _ "We've bided our time for so long, we can do so a little while longer..." 
		[/message]
		[kill]
		id=Echidna
		[/kill]
		[move_unit_fake]
		type=BMR Spark
		x=47,51
		y=7,1
		side=4
		[/move_unit_fake]
		[message]
		speaker=Nemesis
		message= _ "No, no you don't..."
		[/message]		
		{MOVE_UNIT id=Nemesis 51 1}
		[kill]
		id=Nemesis
		[/kill]
		[message]
		speaker=Raenna
		message= _ "We will all die...  Wait, that sphere..."
		[/message]
		[message]
		role=Follower3
		message= _ "What?  What about the sphere?"
		[/message]
		[music]
		name="siege_of_laurelmor.ogg"
		immediate=yes
		[/music]
		[objectives]
		side=3
			[objective]
			condition=win
			description=_ "Take the sphere out to the snowy battlefield."
			[/objective]
			[objective]
			condition=lose
			description= _ "Death of Raenna"
			[/objective]
		[/objectives]
		[message]
		speaker=Raenna
		message= _ "We need to prevent the erruption, but that would not deal with the demons.  However, if this sphere can blow the top off of a mountain..."
		[/message]
		[message]
		role=Follower3
		message= _ "Ah...  I see what you're getting at it.  At least we take them down with us."
		[/message]
	[/event]

# Raenna picks up the sphere.  Primevals turn on her and the Primevalists.

	[event]
	name=moveto
		[filter]
		id=Raenna
		x,y=52,6
		[/filter]
		[set_variable]
		name=has_sphere
		value=1
		[/set_variable]
	    [print]
		text= _ "Raenna has the sphere."
	        duration=100
		size=24
		red,green,blue=-255,-255,255
	    [/print]
		[message]
		speaker=Raenna
		message= _ "This sphere is rather hot.  I hope there is enough time..."
		[/message]
		[removeitem]
		x,y=52,6
		[/removeitem]
		[message]
		side=5
		message= _ "*What are you doing!?"
		[/message]
		[message]
		speaker=Ares
		message= _ "Using humans was a mistake.  Yet another of Athanta's strange ideas..."
		[/message]
		[modify_side]
		side=3
		team_name=good
		[/modify_side]
	[/event]

	[event]
	name=moveto
	first_time_only=no
		[filter]
		id=Raenna
		x=20-47
		[/filter]
		[if]
		    [variable]
			name=has_sphere
			numerical_equals=1
		    [/variable]
		    [then]
			[message]
			speaker=Raenna
			message= _ "The sphere is cooling off...  That probably means I have time to get this out, but what if nothing happens?"
			[/message]
			[set_variable]
			name=has_sphere
			value=2
			[/set_variable]
			{QUAKE "rumble.ogg"}
# western hole
			[terrain]
			terrain=Uu
			x=30-32
			y=25-31
			[/terrain]
			[terrain]
			terrain=Uh
			x=32,33,29-33
			y=27,30,32-35
			[/terrain]
			[terrain]
			terrain=Qlf
			x=33,33,34,29,28
			y=31,29,33,27,28
			[/terrain]
# eastern hole
			[terrain]
			terrain=Uu
			x=45-47
			y=34-40
			[/terrain]
			[terrain]
			terrain=Uh
			x=46,45
			y=36,41
			[/terrain]
			[terrain]
			terrain=Qlf
			x=46,46,45,46,34
			y=37,38,37,14,8
			[/terrain]
# this did not do anything 1.6a
			[terrain]
			terrain=Ql^li
			x=52,51
			y=6,6
			[/terrain]
			[remove_shroud]
			side=3
			x=19-64
			y=25-38
			[/remove_shroud]
			[redraw][/redraw]
		    [/then]
		[/if]
	[/event]

# lava spots are appearing on the ground in random locations
# variable "has_sphere" starts to increase once Raenna is out of the temple-ish region
# and events can be triggered, but not immediately
	[event]
	name=new turn
	first_time_only=no
		[if]
		    [variable]
			name=has_sphere
			greater_than_equal_to=2
		    [/variable]
		    [then]
			[set_variable]
			name=has_sphere
			add=1
			[/set_variable]
			[set_variable]
			name=lava1
			rand=1..4
			[/set_variable]
			[if]
			    [variable]
				name=lava1
				numerical_equals=2
			    [/variable]
				[then]
			[set_variable]
			name=lava_x
			rand=1..80
			[/set_variable]
			[set_variable]
			name=lava_y
			rand=1..70
			[/set_variable]
			[terrain]
			terrain=Ql
			x=$lava_x
			y=$lava_y
			[/terrain]
			[redraw][/redraw]
			{QUAKE "cave-in.ogg"}
		    		[/then]	
			[/if]
# the "plan" may not be that clear to the player, hopefully this clears it up
# may need to add some more of this sort of thing
			[if]
			    [variable]
				name=has_sphere
				numerical_equals=6
			    [/variable]
			    [then]
			    [message]
				speaker=Raenna
				message= _ "This sphere appears dead, the plan may not work...  Maybe the sphere needs to be heated?"
			    [/message]
			    [/then]
			[/if]
			{CLEAR_VARIABLE lava_x}
			{CLEAR_VARIABLE lava_y}
			{CLEAR_VARIABLE lava1}
		    [/then]
		[/if]
	[/event]	

# give the new ukians the glow, but only after they are khthon
	[event]
	name=recruit
	first_time_only=no
		[filter]
		race=ukian
		[/filter]
	    [if]
		[variable]
		name=open_cave
		greater_than_equal_to=1
		[/variable]
		[then]
# $x1,$y1 does not appear to work...  no, the halo thing just doesn't work
#		{MODIFY_UNIT side=1 halo "halo/echidna.png"}
#		{MODIFY_UNIT side=4 halo "halo/echidna.png"}
		{MODIFY_UNIT side=1 race khthon}
		{MODIFY_UNIT side=4 race khthon}
		[/then]
	    [/if]
	[/event]

	[event]
	name=new turn
	first_time_only=no
	    [if]
		[variable]
		name=open_cave
		numerical_equals=1
		[/variable]
		[then]
			[set_variable]
			name=open_cave
			add=1
			[/set_variable]
			[unstore_unit]
			variable=c_belleros
			[/unstore_unit]
		{GENERIC_UNIT 1 "Ukian Runner" 49 26}
		{GENERIC_UNIT 1 "Ukian Archer" 47 25}
		{GENERIC_UNIT 1 "Ukian Regular" 46 28}
		{GUARDIAN}
		{GENERIC_UNIT 1 "Ukian Officer" 27 20}
		{GUARDIAN}
		{GENERIC_UNIT 1 "Ukian Hawkeye" 33 17}
		{GUARDIAN}
		{GENERIC_UNIT 1 "Ukian Signalman" 33 21}
		{GUARDIAN}
		[gold]
		amount=100
		side=5
		[/gold]
		[/then]
	    [/if]
	[/event]

	[event]
	name=moveto
	first_time_only=no
		[filter]
		id=Raenna
		y=37-70
		    [filter_location]
			[filter_adjacent_location]
			count="1-6"
			adjacent="n,ne,se,s,sw,nw"
			terrain=Ql,Qlf
			[/filter_adjacent_location]
		    [/filter_location]
		[/filter]
		[if]
		    [variable]
			name=has_sphere
			greater_than=4
		    [/variable]
		    [then]
			[music]
			name="heroes_rite.ogg"
			immediate=yes
			[/music]
			[message]
			speaker=Raenna
			message= _ "I'm clear of the volcano top, but the sphere has gone cold...  I'll try tossing it in this lava."
			[/message]
			[role]
			    role=Follower4
			    type="Primevalist Fighter","Primevalist Follower","Primevalist Fanatic","Primevalist Monk"
			[/role]
			[message]
			role=Follower4
			message= _ "Wait!  Won't that be the same as having left it back in the cave?"
			[/message]
			[message]
			speaker=Raenna
			message= _ "Maybe, but I have a feeling there was something special about that temple.  Why else is Ares still present?  Here it goes!"
			[/message]
			[message]
			speaker=Ares
			message=_  "*NO!"
			[/message]
			{QUAKE "rumble.ogg"}		
			{THUNDER (
			[kill]
			id=Ares
			animate=yes
			[/kill]
			[kill]
			id=Raenna
			animate=yes
			[/kill]
			[kill]
			side=3
			animate=no
			[/kill]
			[kill]
			side=4
			animate=no
			[/kill]
			[kill]
			side=5
			animate=no
			[/kill]
			[kill]
			side=6
			animate=no
			[/kill]
			)}
			{FADE_TO_BLACK}
			[endlevel]
			result=continue
			music="heroes_rite.ogg"
			[/endlevel]
		    [/then]
	    	[/if]
	[/event]		

	[event]
	name=die
		[filter]
		id=C_Belleros
		[/filter]
		[if]
		[variable]
		name=open_cave
		numerical_equals=0
		[/variable]
		[then]
		[message]
		speaker=Athanta
		message= _ "We stopped that fire before it began..."
		[/message] 
		[message]
		speaker=Ares
		message= _ "Ha!  Now let us get to work..."
		[/message] 
		[message]
		speaker=Raenna
		message= _ "(no...)"
		[/message] 
		[endlevel]
		result=defeat
		[/endlevel]
		[/then]
		[else]
		[message]
		speaker=Raenna
		message= _ "Belleros, you poor bastard.  What a strange path it's been..."
		[/message] 
		[music]
		name=suspense.ogg
		immediate=yes
		[/music]
		[/else]
		[/if]
	[/event]

	[event]
	name=turn 35
		[gold]
		amount=350
		side=5
		[/gold]
	[/event]
[/scenario]
